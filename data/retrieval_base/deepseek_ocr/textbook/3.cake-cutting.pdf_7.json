[
  {
    "page_idx": 0,
    "text": "Procedure CutCake(\\(P, D, \\mathcal{D}_P\\))\n\nFind all the maximal intervals of minimum density \\(\\rho_{\\text{min}}\\) in the cake-cutting problem with cake \\(D\\), players \\(P\\) and solid valuation intervals \\(\\mathcal{D}_P\\);\n\nLet \\(H_1 = \\{h_1', h_1''\\}\\), \\(H_2 = \\{h_2', h_2''\\}\\), ..., \\(H_L = \\{h_L', h_L''\\}\\) be all the maximal intervals of minimum density \\(\\rho_{\\text{min}}\\); // \\(H_1, H_2, \\ldots, H_L\\) are mutually disjoint by Corollary 5\n\nfor \\(\\ell = 1\\) to \\(L\\) do\n    cut cake \\(D\\) at both endpoints \\(h_\\ell', h_\\ell''\\) of \\(H_\\ell\\);\n    \\(R_\\ell = \\{k \\in P \\mid D_k \\subseteq H_\\ell, D_k \\in \\mathcal{D}_P\\}\\); \\(\\mathcal{D}_{R_\\ell} = (D_k \\in \\mathcal{D}_P : k \\in R_\\ell)\\);\n    CutMaxInterval(\\(R_\\ell, H_\\ell, \\mathcal{D}_{R_\\ell}\\));\n    \\(P' = P\\); \\(D' = D\\); for \\(\\ell = 1\\) to \\(L\\) do \\(P' = P' \\setminus R_\\ell\\); \\(D' = D' \\setminus H_\\ell\\);\n    if \\(P' \\neq \\emptyset\\) then // \\(P' = P \\setminus \\bigcup_{\\ell=1}^L R_\\ell\\) and \\(D' = D \\setminus \\bigcup_{\\ell=1}^L H_\\ell\\)\n    \\(\\mathcal{D}'_{P'} = \\emptyset\\);\n    for each \\(D_k \\in \\mathcal{D}_P\\) with \\(k \\in P'\\) do \\(D'_k = D_k \\setminus \\bigcup_{\\ell=1}^L H_\\ell\\); \\(\\mathcal{D}'_{P'} = \\mathcal{D}'_{P'} + \\{D'_k\\}\\);\n    Perform shrinking of all \\(H_1, H_2, \\ldots, H_L\\);\n    Let \\(D^{(S)}, D^{(S)}_k \\in \\mathcal{D}^{(S)}_{P'}\\), and \\(\\mathcal{D}^{(S)}_{P'}\\) be obtained from \\(D', D'_k \\in \\mathcal{D}'_{P'}\\), and \\(\\mathcal{D}'_{P'}\\) by shrinking of all \\(H_1, H_2, \\ldots, H_L\\), respectively;\n    CutCake(\\(P', D^{(S)}, \\mathcal{D}^{(S)}_{P'}\\)); Perform inverse shrinking of all \\(H_1, H_2, \\ldots, H_L\\);\n\nNote that, if \\(P' \\neq \\emptyset\\) after the deletion of \\(H_1, H_2, \\ldots, H_L\\) and CutCake(\\(P', D^{(S)}, \\mathcal{D}^{(S)}_{P''}\\)) is recursively called, then the minimum density \\(\\rho'_{\\text{min}}\\) in CutCake(\\(P', D^{(S)}, \\mathcal{D}^{(S)}_{P'} \\)) satisfies \\(\\rho'_{\\text{min}} > \\rho_{\\text{min}}\\) by Lemma 6. Next, we give a detailed description of CutMaxInterval(\\(R, H, \\mathcal{D}_R\\)) based on Lemma 7 and Procedure CutMinInterval(\\(S, X, \\mathcal{D}_S\\)).\n\nProcedure CutMaxInterval(\\(R, H, \\mathcal{D}_R\\))\n\nLet \\(X_1 = \\{x_1', x_1''\\}\\), \\(X_2 = \\{x_2', x_2''\\}\\), ..., \\(X_K = \\{x_K', x_K''\\}\\) be all the minimal intervals of minimum density \\(\\rho_{\\text{min}}\\) in \\(H\\); // \\(X_1, X_2, \\ldots, X_K\\) are mutually disjoint by Corollary 5\n\nfor \\(k = 1\\) to \\(K\\) do\n    cut cake \\(H\\) at both endpoints \\(x'_k, x''_k\\) of \\(X_k\\);\n    \\(S_k = \\{i \\in R \\mid D_i \\subseteq X_k, D_i \\in \\mathcal{D}_R\\}\\); \\(\\mathcal{D}_{S_k} = (D_i \\in \\mathcal{D}_R : i \\in S_k)\\);\n    CutMinInterval(\\(S_k, X_k, \\mathcal{D}_{S_k}\\));\n    \\(R' = R\\); \\(H' = H\\); for \\(k = 1\\) to \\(K\\) do \\(R' = R' \\setminus S_k\\); \\(H' = H' \\setminus X_k\\);\n    if \\(R' \\neq \\emptyset\\) then // \\(R' = R \\setminus \\bigcup_{k=1}^K S_k\\) and \\(H' = H \\setminus \\bigcup_{k=1}^K X_k\\)\n    \\(\\mathcal{D}'_{R'} = \\emptyset\\);\n    for each \\(D_i \\in \\mathcal{D}_R\\) with \\(i \\in R'\\) do \\(D'_i = D_i \\setminus \\bigcup_{k=1}^K X_k\\); \\(\\mathcal{D}'_{R'} = \\mathcal{D}'_{R'} + \\{D'_i\\}\\);\n    Perform shrinking of all \\(X_1, X_2, \\ldots, X_K\\);\n    Let \\(H^{(S)}, D^{(S)}_i \\in \\mathcal{D}^{(S)}_R\\), and \\(\\mathcal{D}^{(S)}_R\\) be obtained from \\(H', D'_i \\in \\mathcal{D}'_{R'}\\), and \\(\\mathcal{D}'_{R'}\\) by shrinking of all \\(X_1, X_2, \\ldots, X_K\\), respectively;\n    CutMaxInterval(\\(R', H^{(S)}, \\mathcal{D}^{(S)}_R\\)); Perform inverse shrinking of all \\(X_1, X_2, \\ldots, X_K\\);\n\nNote that, if \\(R' \\neq \\emptyset\\) after deletion of \\(X_1, X_2, \\ldots, X_K\\) and CutMaxInterval(\\(R', H^{(S)}, \\mathcal{D}^{(S)}_R\\)) is recursively called, then the minimum density \\(\\rho'_{\\text{min}}\\) in CutMaxInterval(\\(R', H^{(S)}, \\mathcal{D}^{(S)}_R \\)) satisfies \\(\\rho'_{\\text{min}} = \\rho_{\\text{min}}\\) by Lemma 7. As mentioned before, Procedure CutMinInterval(\\(S, X, \\mathcal{D}_S\\)) is the core method for solving the cake-cutting problem where cake \\(X\\) is a minimal interval of minimum density in maximal interval \\(H\\) of minimum density \\(\\rho_{\\text{min}}\\), players \\(S = R(X) = \\{i \\in R \\mid D_i \\in \\mathcal{D}_R, D_i \\subseteq X\\}\\) and solid valuation intervals \\(\\mathcal{D}_S = \\mathcal{D}_{R(X)} = (D_i \\in \\mathcal{D}_R : i \\in S)\\)."
  }
]