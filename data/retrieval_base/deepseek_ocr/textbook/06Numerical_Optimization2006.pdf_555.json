[
  {
    "page_idx": 0,
    "text": "of approximating it with a positive definite matrix may be problematic. BFGS updating requires that \\( s_k \\) and \\( y_k \\) satisfy the curvature condition \\( s_k^T y_k > 0 \\), which may not hold when \\( s_k \\) and \\( y_k \\) are defined by (18.13), even when the iterates are close to the solution.\n\nTo overcome this difficulty, we could skip the BFGS update if the condition\n\n\\[\ns_k^T y_k \\geq \\theta s_k^T B_k s_k\n\\]  \n\n(18.14)\n\nis not satisfied, where \\( \\theta \\) is a positive parameter (10\\(^{-2}\\), say). This strategy may, on occasion, yield poor performance or even failure, so it cannot be regarded as adequate for general-purpose algorithms.\n\nA more effective modification ensures that the update is always well defined by modifying the definition of \\( y_k \\).\n\n**Procedure 18.2** (Damped BFGS Updating).\n\nGiven: symmetric and positive definite matrix \\( B_k \\);\nDefine \\( s_k \\) and \\( y_k \\) as in (18.13) and set\n\n\\[\nr_k = \\theta_k y_k + (1 - \\theta_k) B_k s_k,\n\\]\n\nwhere the scalar \\( \\theta_k \\) is defined as\n\n\\[\n\\theta_k = \n\\begin{cases} \n1 & \\text{if } s_k^T y_k \\geq 0.2 s_k^T B_k s_k, \\\\\n(0.8 s_k^T B_k s_k) / (s_k^T B_k s_k - s_k^T y_k) & \\text{if } s_k^T y_k < 0.2 s_k^T B_k s_k;\n\\end{cases}\n\\]  \n\n(18.15)\n\nUpdate \\( B_k \\) as follows:\n\n\\[\nB_{k+1} = B_k - \\frac{B_k s_k s_k^T B_k}{s_k^T B_k s_k} + \\frac{r_k r_k^T}{s_k^T r_k}.\n\\]  \n\n(18.16)\n\nThe formula (18.16) is simply the standard BFGS update formula, with \\( y_k \\) replaced by \\( r_k \\). It guarantees that \\( B_{k+1} \\) is positive definite, since it is easy to show that when \\( \\theta_k \\neq 1 \\) we have\n\n\\[\ns_k^T r_k = 0.2 s_k^T B_k s_k > 0.\n\\]  \n\n(18.17)\n\nTo gain more insight into this strategy, note that the choice \\( \\theta_k = 0 \\) gives \\( B_{k+1} = B_k \\), while \\( \\theta_k = 1 \\) gives the (possibly indefinite) matrix produced by the unmodified BFGS update. A value \\( \\theta_k \\in (0, 1) \\) thus produces a matrix that interpolates the current approximation \\( B_k \\) and the one produced by the unmodified BFGS formula. The choice of \\( \\theta_k \\) ensures that the new approximation stays close enough to the current approximation \\( B_k \\) to ensure positive definiteness."
  }
]